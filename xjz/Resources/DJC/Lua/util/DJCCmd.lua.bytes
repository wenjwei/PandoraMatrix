--------------------------------------------------------- START -------------------------------------------------------
-- 由于不同业务使用游戏命令不同，这里只提供基础常用的命令
-- 本文件包含的游戏基础命令如下（游戏如果没有对应实现可以留空）：
-- @method ShowLoading             : 开启加载状态（转菊花）
-- @method CloseLoading            : 关闭加载状态（转菊花）
-- @method ShowRedDot              : 展示入口红点（Pandora or Game）
-- @method ShowGameMsg             : 使用游戏侧面板展示消息
-- @method NotifyGameReady         : 通知游戏（活动）准备就绪
-- @method NotifyGamePanelCreated  : 通知游戏潘多拉面板已创建
-- @method NotifyGamePanelClosed   : 通知游戏潘多拉面板已关闭（销毁）
-- ...
---------------------------------------------------------- END --------------------------------------------------------
require "Common"

local Cmd = {}
local Util = require "DJCUtil"
local CallGame = Common.CallGame

-----------------------------------------------------------------------------
-- desc 游戏 loading 加载
-----------------------------------------------------------------------------
function Cmd.ShowLoading()
    local tbCmd = {
        -- 命令内容，示例
        type = "showLoading",
        content = "1"
    }

    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc 游戏 loading 关闭
-----------------------------------------------------------------------------
function Cmd.CloseLoading()
    local tbCmd = {
        -- 命令内容，示例
        type = "showLoading",
        name = "0"
    }

    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc 展示红点入口
-- @param iRedDotNum : number 红点数
-----------------------------------------------------------------------------
function Cmd.ShowRedDot(iRedDotNum)
    -- TODO 展示红点入口具体逻辑、视业务
end

-----------------------------------------------------------------------------
-- desc 游戏消息弹窗（注：如果业务没有该协议，请自行在 panel 中实现）
-- @param sMsg : string 消息内容
-----------------------------------------------------------------------------
function Cmd.ShowGameMsg(sMsg)
    local tbCmd = {
        -- 命令内容，示例
        type = "showTip",
        content = sMsg
    }

    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc 通知游戏资源准备就绪
-- @param sPanelName : string 面板名
-----------------------------------------------------------------------------
function Cmd.NotifyGameReady(sPanelName)
    local tbCmd = {
        -- 命令内容，示例
        type = "state",
        name = "ready",
        content = sPanelName
    }

    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc 通知游戏面板创建
-- @param sPanelName : string 面板名
-----------------------------------------------------------------------------
function Cmd.NotifyGamePanelCreated(sPanelName)
    local tbCmd = {
        -- 命令内容，示例
        type = "state",
        name = "open",
        content = sPanelName
    }

    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc 通知游戏面板关闭
-- @param sPanelName : string 面板名
-----------------------------------------------------------------------------
function Cmd.NotifyGamePanelClosed(sPanelName)
    local tbCmd = {
        -- 命令内容，示例
        type = "state",
        name = "close",
        content = sPanelName
    }

    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc 刷新元宝
-----------------------------------------------------------------------------
function Cmd.RefreshMoney()
    local cmdTable = {}
    cmdTable["type"] = "refreshMoney"
    local cmdJson = Util.JEncode(cmdTable)
    CallGame(cmdJson)
end

-----------------------------------------------------------------------------
-- desc 刷新邮箱
-----------------------------------------------------------------------------
function Cmd.RefreshMail()
    local tbCmd = {
        -- 命令内容，示例
        type = "getGoods",
        content = ""
    }

    CallGame(Util.JEncode(tbCmd))
end
-----------------------------------------------------------------------------
-- desc ios 拉起米大师支付（固定协议，如果不生效请联系该业务潘多拉 sdk 接入同学确认协议是否接入）
-- @param sInfoId  : string 活动ID
-- @param sOfferId : string 订单ID
-- @param sProId   : string 商品ID
-- @param sPf      : string 道聚城PF字段
-- @param sPfExt   : string PF扩展字段
-- @param sPayItem : string 购买道具
-----------------------------------------------------------------------------
function Cmd.IosRMBPay(sInfoId, sOfferId, sProId, sPf, sPfExt, sPayItem)
    local tbCmd = {
        type = "midasPay",
        content = "rmb",
        platId = "0",
        actionInfoId = sInfoId or "",
        offerId = sOfferId or "",
        productId = sProId or "",
        pf = sPf or "",
        pfExt = sPfExt or "",
        payItem = sPayItem or ""
    }
    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc android 拉起米大师支付（固定协议，如果不生效请联系该业务潘多拉 sdk 接入同学确认协议是否接入）
-- @param sInfoId        : string 活动ID
-- @param sOfferId       : string 订单ID
-- @param sProId         : string 商品ID
-- @param sGoodsTokenUrl : string 商品TokenUrl
-----------------------------------------------------------------------------
function Cmd.AndroidRMBPay(sInfoId, sOfferId, sGoodsTokenUrl)
    local tbCmd = {
        type = "midasPay",
        content = "rmb",
        platId = "1",
        actionInfoId = sInfoId or "",
        offerId = sOfferId or "",
        goodsTokenUrl = sGoodsTokenUrl or ""
    }
    CallGame(Util.JEncode(tbCmd))
end

-----------------------------------------------------------------------------
-- desc 打开游戏指定面板
-----------------------------------------------------------------------------
function Cmd.ShowGameWindow(PanelName, param1, param2)
    local numPanelName = tonumber(PanelName) or 0
    local msg = {
        type = "ShowGameWindow",
        content = tostring(numPanelName)
    }
    if param1 then
        msg["param1"] = param1
    end
    if param2 then
        msg["param2"] = param2
    end
    CallGame(Util.JEncode(msg))
end

return Cmd
